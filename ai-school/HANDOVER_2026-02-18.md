# Handover (2026-02-18)

## 状態サマリ
- GitHub `main` は最新までpush済み（前回: `HANDOVER_2026-02-17.md` 参照）。
- Firebase Hosting へのデプロイは「サイト本体（動画なし）」は成功し、`courses.json` は新コース（動画03〜10）に更新済み。
- ただし動画は本番で 404 のまま（`/videos/*.mp4` がHostingに存在しない）。

## できなかったこと（このPCで失敗したこと）
### 1) Firebase Hosting に mp4 を含めてデプロイ
- 失敗箇所: `upload-firebasehosting.googleapis.com` へのアップロードがリトライ枯渇で失敗。
- `--debug` で特定できた失敗対象（hash）:
  - `/videos/動画04_業務効率化テクニック集_pdf.mp4`
  - hash: `e48ae2ed7f5039c67e09cea71e9303608c69b884ad3ff97efcd43bb2bb6b9ccd`
- 影響: 本番で `https://eeeemo-aischool.web.app/videos/...mp4` が 404 になり再生不可。

## 次のPCでやること（最短手順）
### A) 現行方式を維持して「Hostingで mp4 配信」する場合
1. 動画が `ai-school/videos/*.mp4` に揃っていることを確認
2. Node 20 を使って deploy（アップロード同時数を下げる）

```bash
cd /home/kogis/eeeemoai-school/ai-school

# Node 20 (nvm想定)
source "$HOME/.nvm/nvm.sh"
nvm install 20.20.0
nvm use 20.20.0

export FIREBASE_HOSTING_UPLOAD_CONCURRENCY=1
npx -y firebase-tools@latest deploy --only hosting --project eeeemo-aischool
```

3. 動画が200で返るかチェック

```bash
curl -I -s 'https://eeeemo-aischool.web.app/videos/%E5%8B%95%E7%94%BB04_%E6%A5%AD%E5%8B%99%E5%8A%B9%E7%8E%87%E5%8C%96%E3%83%86%E3%82%AF%E3%83%8B%E3%83%83%E3%82%AF%E9%9B%86_pdf.mp4' | head -n 1
```

### B) 方式変更して「動画はHosting以外」に逃がす場合（安定）
- `courses.json` の `video` を外部の絶対URLに変更し、Hostingは軽量デプロイにする。
- この場合、`videos/*.mp4` をHostingへ置く必要がなくなる（404問題を根本回避）。

## 本番確認コマンド（サイト更新確認）
```bash
curl -I -s https://eeeemo-aischool.web.app/courses.json | head -n 1
curl -s https://eeeemo-aischool.web.app/courses.json | head -c 200
```

